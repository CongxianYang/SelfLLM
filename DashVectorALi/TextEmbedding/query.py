#语义检索：向量查询
# 在把QBQTC训练数据集里的title内容都写到DashVector服务上的集合里后，就可以进行快速的向量检索，
# 实现“语义搜索”的能力。继续上面代码的例子，
# 假如我们要搜索有多少和'应届生 招聘'相关的title内容，可以通过在DashVector上去查询'应届生 招聘'，
# 即可迅速获取与该查询语义相近的内容，以及对应内容与输入之间的相似指数。
# 基于向量检索的语义搜索
from dashvector import Client, Doc
if __name__ == '__main__':
    # 初始化 DashVectorALi client
    client = Client(
      api_key='sk-6JT6rEZyd3PHF5GIdWVHi1egkmLef43726A0248A511EF94929E3B7F8A78BB',
       endpoint='vrs-cn-k963u8r13000b7.dashvector.cn-shanghai.aliyuncs.com'
)

# 指定集合名称和向量维度
    collection = client.get('sample')
    assert collection
    testembedding=[-2.1359401,4.0292201,-0.396986,-1.42465,3.50594,1.27745,-0.46127,0.114848,-1.8343,0.884557,-3.3473599,
                   2.18226,1.4702801,-4.4153399,-2.3661499,1.6140701,-1.84724,2.2511599,-1.45456,1.93159,1.33693,2.1598301,
                   2.31918,-1.49649,3.5478699,1.5185,0.258398,-2.3664801,-2.3099101,0.392525,-3.8773701,4.57582,0.902779,
                   0.774769,1.0083899,-0.438645,0.701915,2.5278201,0.886306,2.59798,-0.109286,1.7708,2.0051301,
                   -2.1737299,0.260589,0.821847,1.22552,-3.3425901,0.732171,-1.14336,-3.6020501,2.81095,
                   -0.863813,1.53708,-0.88315,0.890221,-2.0846901,0.460242,1.99863,-1.0059299,1.49348,
                   -2.6066401,-1.4853899,0.679221,0.422701,-1.94575,5.5049901,-0.0774192,-3.1097801,
                   0.0476385,-3.54773,0.129759,0.883802,-0.268923,1.0819499,0.0522461,
                   2.57939,0.860094,0.233736,-1.2440701,2.3592501,-3.0848401,-2.42063,3.4755599,3.3683701,
                   -3.33183,1.64036,0.388387,0.339257,2.1046,-0.832652,-0.979996,-0.779501,2.45507,1.59949,
                   -0.344305,1.66594,-0.624849,2.7994201,-0.427679,-0.935617,1.7501301,-3.8053,-1.09728,
                   -0.6182,-0.834908,1.71129,-2.8534801,-2.05285,0.718048,-1.45871,1.96025,-1.68738,1.1715,0.913983,
                   -2.1515,0.427282,3.9904101,-1.0942301,-3.15311,1.1547101,-1.4938,-1.00993,0.459766,-1.75002,-1.7100199,
                   1.2781399,0.159164,3.6062901,1.02464,2.38816,-2.39696,-1.24694,-1.3710001,1.02174,1.28483,-1.6246001,
                   -0.13399,1.2625999,-3.9021499,-2.3129101,0.983564,-0.0492543,0.446569,-4.6675701,1.6627899,-1.35265,-0.413854,
                   -0.442522,1.22842,5.39292,-0.304767,-3.1306,-1.5888799,-0.639999,-0.762544,-0.312311,3.1945701,3.0156,-0.837706,
                   2.1192999,-1.67362,-0.0187733,-0.8221,0.657102,-0.612369,-3.0150299,-2.1164401,-1.64913,-0.8793,0.293879,
                   1.1564699,1.05716,-0.387797,-3.58564,-0.237904,2.08833,0.689604,-3.3443899,-2.2430201,0.647074,-
                   0.0406095,-1.49313,2.3280001,2.0525501,0.824237,1.5219899,1.50925,-1.1526099,0.767343,-0.988499,
                   -0.0780629,-1.22955,-1.40128,-1.04728,1.08382,-3.3672099,1.7297601,2.49786,-0.118246,-0.472011,
                   1.0254,-6.4454198,-3.81743,1.1751699,0.354892,0.500033,-0.614116,-1.01141,-0.232096,0.566988,
                   -1.94375,3.1853499,-0.939085,-0.721165,0.402231,-1.36261,-1.70652,0.440177,-0.448961,-1.0047801,
                   1.44065,2.4442599,-0.570446,-4.9832702,-1.9259501,1.30575,-2.2315199,-0.041424,-2.5638399,
                   -5.4618802,1.5427099,1.48362,0.788992,1.32083,1.45148,0.976345,0.963565,0.210079,-1.04932,
                   2.91452,-0.680087,-1.1225801,-0.521838,1.6139801,-3.9514201,1.88924,0.261286,-0.700635,0.140416,
                   -3.0204899,1.96759,-1.01151,2.3059599,1.76437,-0.301802,-0.440678,-1.24172,-1.11387,-0.563082,0.459224,
                   1.04162,1.77068,2.26459,2.94134,2.5740099,1.9158601,2.1528599,-1.86297,0.183359,1.9591399,-2.34831,-1.82751,
                   2.96789,0.260878,-1.19803,0.74527,5.7667699,2.7042699,1.0269001,-0.470224,-4.6556001,1.51327,-0.476346,2.12255,
                   -0.0551375,-0.884419,-3.9569199,1.67485,0.434291,5.21489,3.75545,-2.14975,-5.1771102,-0.332076,-4.7659502,
                   0.0157049,0.366606,2.30597,2.8703201,0.586796,0.682599,-1.10683,-4.3733001,-0.848234,-0.0201083,-0.778036,
                   1.55641,-0.619425,-4.2490301,-3.6886599,-4.6301799,0.4837,0.394003,-0.77468,-2.4332199,-0.672572,-0.381097,
                   0.42952,0.75771,-2.8901701,-3.37005,-0.952418,4.1605301,2.07915,0.13906,-1.4245,0.875113,2.0032401,-2.51226,
                   -4.0879698,-0.279244,-5.9000201,1.7794,3.9920101,-3.4523201,-0.799712,0.801436,2.05743,3.1282201,-3.14115,
                   -2.9605899,1.89001,-3.55445,2.7289,3.02109,0.196167,1.5457,-2.1753399,-3.1919,-2.41032,4.5136499,2.27633,1.36329,
                   -3.2901499,3.26827,2.2532899,3.5736401,-1.12719,-5.9384398,2.6598499,-2.9017,-3.3292301,0.084739,3.6187699,1.31115,
                   0.69177,-3.1482601,3.13763,-1.20377,0.0184082,-3.53109,-0.140666,-0.35475,-3.01387,2.8056099,0.0234664,-0.461222,
                   1.4651099,-2.94047,-0.566664,1.21829,5.46697,-3.33161,2.79581,-0.533243,-0.615123,0.747164,-2.88082,-2.4814,2.0137501,
                   3.6997199,-0.174441,-4.1317101,0.397068,2.43344,-1.45237,-3.4373,-0.555462,-1.97308,-0.154268,-1.66124,0.294477,
                   3.29228,-0.0330589,-0.898209,-0.145628,-1.78799,-6.1617298,1.39972,0.207024,-2.84442,1.01761,1.41301,-1.5984499,-0.472528,
                   0.945674,-2.0127599,4.5327401,2.14345,1.1913199,0.322763,-0.158427,-0.410769,-3.4126699,-1.3908401,0.551074,0.0093018,-3.3446701,
                   2.9574599,-1.6652499,0.621532,-2.0148101,-1.02341,0.115132,1.4977,1.47357,-2.0749199,4.1676602,0.860067,-0.11496,-3.04004,2.64469,
                   3.5562,0.444668,2.01436,-0.617944,-0.136439,1.7164201,2.21521,5.4015398,-1.0142,0.513945,1.62256,1.08943,1.78157,-2.93506,-0.389706,
                   3.5725999,1.66114,-2.07833,2.29967,1.4308,-0.886648,0.423708,2.1022301,4.7058001,-1.24798,-4.6581702,-1.08507,-3.86145,0.817725,-1.5569,
                   1.21532,-0.538068,3.64377,2.7448499,-0.106754,-1.74499,-0.306206,-2.53212,0.548171,0.682582,-0.84632,0.769661,-0.973766,-2.7955101,-1.69437,
                   2.26531,1.03122,3.0961599,0.510631,0.441035,3.10812,-0.626684,1.6246901,-1.6373,-7.0545301,1.22473,2.8722701,-2.1308,0.685744,3.0859399,0.549689,
                   1.5725501,-4.1428399,0.137442,-0.394824,-11.3437996,-1.21859,-3.7478499,0.766908,-2.3894899,-2.5701201,-1.92494,-0.133842,4.3081899,-1.7404799,
                   0.996103,1.43744,2.75543,-1.5664099,-1.6166199,3.1915901,-1.95474,0.951443,0.413458,1.1000201,3.87853,-1.36254,-1.31043,2.15802,4.0728898,
                   -4.26829,-1.8741699,5.54213,0.675439,0.773386,-1.4754601,1.12649,-3.50705,4.4036198,3.3541,1.98522,-3.2119601,1.12098,-1.01206,3.9367399,
                   -0.538419,3.7609899,-0.0190874,2.6928401,1.6019599,1.1479599,-2.2175701,4.7255502,-0.542609,-0.147479,-0.602779,1.61633,0.73667,0.755974,
                   -0.635357,-1.24049,2.70911,-3.5985301,3.24914,0.0039506,5.5239,9.29529,0.0843173,1.9038,-2.63556,2.20297,-0.922001,0.71272,3.87937,-3.3475699,
                   0.46435,-0.31452,5.5710502,-1.93918,0.0226673,2.5188899,1.95581,-0.854503,-1.70398,-1.40532,2.15289,3.8120999,0.838215,-1.4017,-1.2861201,-0.0006228,1.46873,0.413772,0.996937,-0.0993686,-2.5725501,-1.70262,2.37884,-2.18997,3.3420899,-0.509701,2.3784699,0.479474,1.30799,-1.82544,0.210498,-0.849938,-0.937935,-1.96258,-0.330251,0.810547,-4.3014898,-3.34956,-3.4744799,2.9927499,-1.6193399,1.15286,1.16764,-0.466425,0.260727,2.4720199,1.01394,-5.0980501,1.99537,1.37342,-3.16172,0.738983,3.69945,9.4015598,-3.47667,-0.0399281,-1.21682,-3.47155,4.0781298,-1.68445,-2.73558,-1.94433,-3.49474,-1.23295,1.00213,-1.2435,2.12622,-0.556072,-1.2758501,0.949063,0.0778098,-3.2293501,1.31037,-2.87041,3.38872,-1.6272,-2.8989301,1.80563,0.0084384,2.6967399,1.87985,0.793204,-2.63083,3.2588201,-1.87414,4.66188,0.966748,1.53774,0.50121,4.6847601,-1.84339,3.3048501,-1.01853,1.9294699,-6.52844,1.23975,1.4662499,2.6603899,-2.5248401,-1.02376,1.9373,-3.12309,2.2616601,4.44174,5.2692499,0.772252,-2.91559,-1.1197701,-0.853507,-4.57196,0.34474,2.1883099,-1.4428,-2.60113,-0.37005,2.45613,1.58768,0.781559,0.83628,1.7927001,2.85923,1.4681,0.139465,-1.73795,4.5887499,0.794254,0.151514,-1.0176001,-3.2051699,-0.782837,2.3665299,3.5357599,2.19345,-1.8542,-13.6113997,-1.3649499,0.434588,-1.89044,-0.0961501,-4.8794498,-0.248841,-2.13539,-1.71322,2.7323799,1.26008,-3.9374101,3.30354,-1.62515,-1.35149,1.76036,-2.25103,1.54632,-0.315798,2.20557,0.616788,2.24962,0.165492,1.57105,1.69007,1.29899,-1.1799001,1.67717,-3.7011001,-2.9847901,1.92314,4.1205301,-1.58494,-1.6138999,0.715422,1.2571,2.41783,-0.671038,-1.44891,-0.498717,-0.906612,-0.562442,2.4093001,-1.14426,-1.24023,-1.04787,-0.517203,-0.124608,-2.99897,0.371511,4.3573999,-0.951929,4.8649998,1.84925,-1.7592,-1.03599,-0.173305,1.26079,-1.08679,1.03655,1.72826,3.5359199,7.2077198,-1.03341,0.387948,2.8173699,-1.05241,0.467374,3.25875,-0.927972,-0.714506,3.0115499,0.511863,0.489835,1.29817,-0.197201,0.383793,1.21295,-0.130442,-0.136034,-4.2839298,1.94054,1.56355,1.11174,0.663268,0.101358,4.0170202,2.2065899,-2.4800799,-3.53897,2.8626101,5.3113298,-1.88476,0.858471,3.4262099,-1.76282,2.04549,1.2544399,1.78482,-1.6290801,1.51618,1.46254,-3.3404901,-1.59451,3.70737,-1.25328,-0.741673,2.05597,2.5936401,-4.4760199,0.317929,-0.895121,-4.8306499,-1.28956,-0.542183,1.00438,-3.2918401,-1.3975,-2.5778301,-1.90499,-2.8064599,-4.1189399,-0.641087,-2.4203999,2.7135301,0.86487,-1.05125,-4.30722,0.192081,-0.353189,2.2627299,0.903613,0.321604,0.631576,-2.4876699,-0.023721,-1.93606,-3.9138701,10.4164,-3.29809,0.656938,-2.4883201,1.49464,-1.2983,1.43336,-3.8647799,1.03543,-2.5682199,-1.17258,0.727295,2.5185101,-2.36989,-0.120996,-0.636153,3.3585999,1.38721,0.684615,2.78458,-1.03643,-1.0197001,-1.91315,-3.28091,1.26109,-0.814342,1.36051,-1.68051,3.6066301,-2.25793,-1.35388,2.10198,1.2769001,0.81165,6.78158,0.712983,-2.41399,-1.76151,3.2253599,3.19276,-0.982717,0.431746,1.93375,2.2278099,0.409199,-5.1842499,3.9807401,2.0063901,1.99115,-2.1591001,2.11412,-0.129039,-0.760265,3.36005,-1.0768501,0.0679022,-0.377136,-1.48165,-2.09988,2.76683,-2.5506401,-0.817915,2.74473,-0.466342,-2.0139999,1.43514,-0.803993,-0.942876,2.54861,0.811448,1.8700401,0.903116,1.97589,-0.0163147,5.0510402,-3.41482,-4.8593898,2.62814,-3.64678,-4.3172302,-1.66471,-3.4184699,-0.120773,1.9447401,-1.23945,-2.2195499,0.553153,3.30811,-0.0742143,-1.9210401,0.894802,2.1017599,1.7492599,-0.544309,-2.6022899,-3.3364601,-1.04763,-0.812717,1.6515599,0.555625,0.592951,1.81356,-2.7965701,-3.2177999,-2.44291,2.64112,0.578893,2.19329,0.487112,-1.3379,0.56869,-0.676713,0.516832,-1.40301,1.16312,-3.8052199,1.63372,4.1027899,-2.4432199,-2.04403,-3.08215,-0.732262,0.399991,6.0812201,1.57608,2.60198,-1.32693,-2.6507599,1.22831,0.561681,1.17435,-1.14464,-2.13398,0.76659,-3.3048601,-1.4002,-2.5924799,-0.378889,-0.59269,1.18197,-0.672412,0.25815,-1.58474,3.33743,0.193355,-0.114849,-4.61904,2.0298901,5.3821101,-1.7681299,-0.695515,-1.74553,-5.38308,3.9416299,4.5146899,0.542338,4.4113002,5.0309801,-1.5212899,1.36146,2.22557,0.48983,0.695759,-2.5918,-1.52651,2.45137,-2.8796599,0.457774,-1.19789,0.0592285,-0.404057,-1.01756,-3.5601399,-5.41049,0.902433,-1.04607,-0.5001,0.738244,-3.8516901,2.5966401,-0.588703,-0.0650257,-7.3355799,-0.277006,-3.9755399,1.821,-1.63336,1.14334,1.93707,0.282014,1.40073,1.0228,3.8364301,9.04741,-2.5467999,-2.03773,0.251731,-5.5005398,4.3204699,-0.75524,1.17047,2.8920701,2.8287201,-0.478567,2.1807699,-0.178331,-0.666897,-1.4289,6.3442202,0.934265,-1.33503,-0.798282,3.7941401,3.29336,5.25983,0.465927,0.263497,-3.2253399,-0.74695,-1.15872,1.27079,-1.69769,-1.50836,3.48382,0.61072,-0.459251,0.513612,-2.3238499,3.3652101,0.997365,0.406552,-1.78172,-4.06284,-2.4760799,3.0739801,-0.795428,-2.93472,-2.15344,2.55562,1.2507,3.14202,-0.761363,-0.838068,3.2063301,-1.31911,-1.47255,-0.901607,2.39345,-3.2156301,-0.693648,1.25279,-2.42119,-0.940504,2.90481,-0.709393,2.97651,1.98659,-3.21491,-1.60824,-0.453915,-0.182093,-0.516044,-0.79755,-1.11739,-3.6588199,-5.0654302,0.97221,0.0282038,-0.0825062,2.5926199,-3.0346899,-0.793343,2.0034201,-1.2941099,0.66319,2.08845,0.67207,4.24259,0.744886,-4.4229002,-1.45016,-1.4911,0.232817,-2.9052899,0.526445,-0.742365,1.11376,1.73483,-1.68365,2.2158799,-0.731008,0.93501,-3.0250001,1.49417,-2.8357601,1.15377,0.722552,0.229723,1.42566,1.58806,-0.347541,-0.563519,-3.5805399,-0.791513,-0.366218,2.2196701,-2.4633501,2.4301,-1.77061,1.70218,-0.707059,2.6714699,0.0295898,21.2973003,-3.3612199,-0.527629,1.78032,-2.0831699,0.344305,0.31812,-3.6018701,0.376944,-2.0888,-1.66115,1.6269701,1.42265,-2.0766201,1.9693,-3.2314301,3.0938101,1.22741,-1.64487,-1.25561,-2.6236501,2.4948499,-2.0397401,4.1096001,0.266415,1.22141,-1.7774,0.864867,2.64132,2.4261899,-2.0292599,-1.8218,1.80136,3.53514,2.67611,1.08479,-2.4416299,0.7663,-3.3975301,-1.20442,2.38269,3.2016599,-1.43013,-0.209619,7.27214,3.444,1.18545,4.2988801,-2.9711101,-0.884292,-3.0775599,-2.2444601,5.33462,-0.162678,0.658783,2.92342,-1.7072001,0.0162109,2.7181599,-1.60787,-3.3833799,-0.236932,2.3831601,-0.423065,-1.8481899,-1.56778,0.870348,0.511622,-2.1245699,-1.8841799,0.0043191,-1.25144,-0.378325,2.1417401,1.74248,-0.276003,0.986563,-0.801745,1.1533099,2.63111,-0.727682,1.9152499,-0.548067,2.76174,-5.69909,-3.24001,2.33359,8.0867901,-0.41768,1.8860101,0.39454,-1.78566,-0.698992,4.7081099,-0.539036,-1.48861,-0.716988,1.04994,3.0438001,-0.810628,2.3456299,1.54802,0.0460871,-1.09747,1.70251,-0.203493,2.5263,0.628402,-7.6483798,-3.4479101,-0.0515803,-3.12555,1.2395101,0.220589,3.49735,-3.0385499,0.820071,-0.920708,0.991049,0.933128,-0.0809892,-3.3491299,-1.6534801,-3.53898,0.235608,-0.825515,-3.15186,0.77619,-0.23457,-2.3543401,0.624174,1.20044,-0.728946,-2.41346,-1.25684,2.21316,1.0176899,-2.1788199,-0.121638,2.5366099,-1.32456,-3.98823,-1.91678,-4.0911598,1.1991,4.0301299,-1.92334,0.689353,-4.4124298,-1.78269,-4.58951,0.0235396,-0.967394,0.82677,0.0833252,0.816229,1.8741,-1.12257,0.566207,-0.390683,-1.07399,3.59781,-3.55564,1.27973,2.1096001,1.68082,0.0121626,1.95989,2.99947,-4.2873001,0.323331,2.2992699,-3.97506,1.36517,-0.267336,-0.492618,0.485134,-0.6519,-4.2979999,1.9019901,-1.614,-1.75121,2.72524,2.51459,-2.3359001,1.7926,4.0345898,-1.69956,-3.0749099,-2.1603899,1.72969,-0.511106,1.70754,2.77912,3.1324,0.800355,0.815534,0.314977,2.74052,3.15942,-3.3709199,2.8592601,0.772164,1.8066601,-0.164482,-3.63748,-2.58776,-0.280948,0.399913,-1.30439,2.05232,2.24577,-0.985334,2.65804,-4.6300302,1.80247,4.25067,-2.08465,-1.28426,-0.687691,1.42217,2.37519,-3.2567799,-2.51174,-1.34656,2.08547,-2.79969,-0.0989702,3.38343,2.82851,4.3066602,-3.3101201,4.7502699,-1.25611,1.47579,2.4898601,-0.776615,-1.5716799,-0.793661,-2.3391299,-1.2393301,-2.67805,2.53104,0.595787,-3.1138401,-0.883658,0.237642,-2.4758301,2.6666999,1.32218,1.798,1.73596,6.38908,-2.38534,-2.4921801,2.0318501,1.02033,0.147292,0.897823,-0.23727,-0.0314176,-3.3201001,-2.24983,0.947066,-0.728562,3.29251,2.5429599,0.0001437,1.20868,-5.21381,-1.89237,-2.3175199,-0.343976,2.60636,1.6328,-1.06911,0.152575,4.2648401,0.218013,-0.573748,-1.23511,-4.80126,-0.241457,1.86594,-2.3346601,-0.271196,-0.293939,-4.6575398,3.55006,-1.1068701,2.32213,2.11638,-2.36759,3.39377,0.61469,-6.4593201,-1.4181499,1.65993,1.22565,0.198129,-4.3027902,4.3822198,5.0657902,-2.87221,1.52764,-0.86545,0.165705,0.829652,-0.987398,-0.309332,4.47155,2.15046,-1.47369,1.60396,1.3181,-0.940829,-0.340148,0.772954,-1.42536,2.5903201,0.158071,0.539719,2.2695301,2.55533,-1.17953,-1.6784,-4.4353399,3.49142,-3.14151,-2.0174799,-4.0988998,0.686577,-3.04862,2.54827,0.753888,-0.636477,-0.127708,-2.34659,2.7002201,-2.37761,0.567143,2.22861,-1.75027,-1.77828,1.2848901,1.71078,0.806126,2.36888,-0.702882,0.832275,-1.15089,-1.04166,-0.453796,1.13614,0.950626,1.1785001,-0.521298,0.132275,1.6209199,-0.0471369,-0.52068,0.287345,0.672712,2.94087,-2.41469,-0.520948,-3.29777,1.78465,-1.6159101,0.450153,-1.0416,0.265461,-2.1500499]
    rsp = collection.query(testembedding,output_fields=['title'])

    for doc in rsp.output:
        print(f"id: {doc.id}, title: {doc.fields['title']}, score: {doc.score}")